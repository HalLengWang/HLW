<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToDo Card</title>
    <link rel="stylesheet" type="text/css" href="/todo_card_read_create.css">
</head>
<body>
<div class="navbar">
    <div class="user">이상수 - 골드</div>
    <div class="menu">
        <a href="#">홈</a> |
        <a href="#">업무</a> |
        <a href="#">프로필</a> |
        <a href="#">로그인 / 로그아웃</a>
        <div class="textfield">
            <input type="text" class="search-box" placeholder="Search in site">
            <img class="ic-search" src="/lens.png" alt="검색 아이콘"/>
        </div>
    </div>
</div>
<form class="card" th:object="${todoCardForm}" th:action="@{/todo_card/create}" method="post">
    <input type="hidden" th:value="${todoListId}" name="id"/>
    <div class="header">ToDo Card</div>

    <div class="content">
        <div class="time-section">
            <div class="time">
                <p>시간</p>
                <label for="startDateTime">시작 시간</label>
                <input type="datetime-local"
                       th:field="*{startDateTime}"
                       th:value="${formattedStartDateTime}" />
            </div>
            <br/>
            <div class="time">
                <label for="endDateTime">종료 시간</label>
                <input type="datetime-local" th:field="*{endDateTime}">
            </div>
            <div class="complete">
                </br>
                <div class="checkbox"><input type="checkbox" th:field="*{completion}">완료 여부</div>
            </div>
            <div class="progress">
                <label for="execution">진행도</label>
                <input type="range" min="0" max="100" th:field="*{execution}"
                       oninput="updateProgressValue(this.value)" id="execution-range">
                <!-- 서버에서 받은 execution 값을 표시 -->
                <p id="progress-value" th:text="${todoCardForm.execution} + '%'"></p>
            </div>
        </div>


        <div class="category">
            <p>할일 종류 리스트</p>
            <div th:each="todoType : ${todoTypeList}">
                <input type="radio" th:field="*{category}" th:value="${todoType.id}" th:id="${todoType.id}">
                <label th:for="${todoType.id}" th:text="${todoType.typeName}"></label><br>
            </div>
        </div>
    </div>

    <div class="memo-content">
        <label for="title">제목</label>
        <input type="text" id="title" placeholder="title" th:field="*{title}">

        <label for="memo">메모</label>
        <textarea id="memo" placeholder="메모 내용을 입력하세요." th:field="*{memo}"></textarea>
    </div>

    <button class="save-btn" type="submit">저장</button>
</form>

</body>
</html>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // 슬라이더 값을 서버에서 받은 값으로 초기화
        var executionValue = /*[[${todoCardForm.execution}]]*/ 0;
        var progressValueElement = document.getElementById('progress-value');
        var sliderElement = document.getElementById('execution-range');
    });

    function updateProgressValue(value) {
        // 슬라이더 값을 실시간으로 업데이트
        document.getElementById("progress-value").innerText = value + "%";
    }
</script>
